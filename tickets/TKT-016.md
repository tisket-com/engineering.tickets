
status: resolved
priority: medium
created: 2026-01-25
resolved: 2026-01-25

# TKT-016: Add rename_file MCP tool

## Overview
Add a `rename_file` tool to the MCP that uses `git mv` to rename files properly.

## Problem
Currently renaming files requires a write+delete pattern which:
- Creates 2 separate commits (noisy git history)
- Git doesn't track as a rename (loses file history connection)
- More operations than necessary

## Requirements
- Add `rename_file` tool with `old_path` and `new_path` arguments
- Use `git mv` under the hood to preserve rename tracking
- Auto-commit and push like other file operations
- Return success/error status

## Implementation Notes
- Use isomorphic-git's equivalent of `git mv` (remove + add with same content)
- Or shell out to `git mv` if available
- Ensure proper error handling for missing files, path conflicts

## Implementation

Added `rename_file` tool in:
- `mcp/src/operations/files.ts` - `handleRenameFile` function
- `mcp/src/tools/schemas.ts` - Tool schema definition
- `mcp/src/tools/index.ts` - Handler registration

The tool:
- Takes `old_path` and `new_path` arguments
- Validates paths are within working directory
- Checks old file exists and new path doesn't
- Reads content, writes to new path, deletes old
- Stages both changes in single commit (Git detects as rename)
- Auto-commits with message "Rename X to Y"
- Auto-pushes if GITHUB_PAT is available
- Publishes commit events for realtime updates

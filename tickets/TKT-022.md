---
status: open
priority: medium
created: 2026-01-26
---
# TKT-022: Remove REST API write path from client - use MCP git push

## Summary

The client has two write paths that should be consolidated:
1. **Client tRPC** → REST API `PUT /repos/.../contents/...` (current)
2. **MCP server** → git commit + push (correct approach)

All writes should go through MCP's git push for consistency.

## Current State

`client/src/trpc/routers/repos.ts` uses `updateFileContent()` which:
1. Calls `GET /repos/{org}/{repo}/contents/{path}` to get current SHA
2. Calls `PUT /repos/{org}/{repo}/contents/{path}` to write

This is used for:
- Board updates (lines 390, 415)
- File writes (lines 529, 566)

## MCP Approach (Correct)

MCP server (`mcp/src/operations/`) does:
1. `fs.writeFile()` to local clone
2. `git.commit()` 
3. `git.push()`

This is better because:
- Uses git protocol (separate rate limits from REST API)
- Consistent with the "git as source of truth" architecture
- Proper commit history with author attribution
- SSE events already work with this flow

## Proposed Changes

1. Remove `updateFileContent` from `client/src/lib/github.ts`
2. Update tRPC routes to call MCP for writes instead
3. Or expose write operations through a client-side git push (isomorphic-git supports push)

## Related

- TKT-021: GitHub App evaluation (this fix reduces REST API dependency)
- CLAUDE.md architecture guidelines
